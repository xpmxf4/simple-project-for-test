<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>λ™μ‹μ„± ν…μ¤νΈ λ€μ‹λ³΄λ“</title>
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
</head>
<body>
<div class="container">
    <header>
        <h1>π›’ μ£Όλ¬Έ-κ²°μ  μ‹μ¤ν… λ™μ‹μ„± ν…μ¤νΈ λ€μ‹λ³΄λ“</h1>
        <p class="subtitle">V1 (λ™μ‹μ„± μ΄μ λ°μƒ) vs V2 (ν•΄κ²° λ²„μ „)</p>
    </header>

    <!-- μƒνƒ μ”μ•½ -->
    <section class="summary-section">
        <div class="summary-card">
            <h3>π‘¥ μ‚¬μ©μ</h3>
            <p class="count" th:text="${#lists.size(users)}">0</p>
        </div>
        <div class="summary-card">
            <h3>π“¦ μƒν’</h3>
            <p class="count" th:text="${#lists.size(products)}">0</p>
        </div>
        <div class="summary-card">
            <h3>π« μΏ ν°</h3>
            <p class="count" th:text="${#lists.size(coupons)}">0</p>
        </div>
        <div class="summary-card">
            <h3>π“‹ μ£Όλ¬Έ</h3>
            <p class="count" th:text="${#lists.size(orders)}">0</p>
        </div>
    </section>

    <!-- μ£Όλ¬Έ μƒμ„± ν…μ¤νΈ -->
    <section class="test-section">
        <h2>π“ μ£Όλ¬Έ μƒμ„± ν…μ¤νΈ</h2>

        <div class="form-group">
            <label>μ‚¬μ©μ μ„ νƒ:</label>
            <select id="userId" class="form-control">
                <option th:each="user : ${users}"
                        th:value="${user.id}"
                        th:text="${user.username + ' (' + user.grade + ', ν¬μΈνΈ: ' + user.pointBalance + ')'}">
                </option>
            </select>
        </div>

        <div class="form-group">
            <label>μƒν’ μ„ νƒ:</label>
            <select id="productId" class="form-control">
                <option th:each="product : ${products}"
                        th:value="${product.id}"
                        th:text="${product.name + ' (μ¬κ³ : ' + product.stockQuantity + ', κ°€κ²©: ' + product.price + 'μ›)'}">
                </option>
            </select>
        </div>

        <div class="form-group">
            <label>μλ‰:</label>
            <input type="number" id="quantity" class="form-control" value="1" min="1">
        </div>

        <div class="form-group">
            <label>μΏ ν° μ„ νƒ (μ„ νƒμ‚¬ν•­):</label>
            <select id="couponId" class="form-control">
                <option value="">μΏ ν° μ—†μ</option>
                <option th:each="coupon : ${coupons}"
                        th:value="${coupon.id}"
                        th:text="${coupon.name + ' (λ‚¨μ€ νμ: ' + coupon.remainingCount + ')'}">
                </option>
            </select>
        </div>

        <div class="form-group">
            <label>μ‚¬μ© ν¬μΈνΈ:</label>
            <input type="number" id="pointsToUse" class="form-control" value="0" min="0">
        </div>

        <div class="form-group">
            <label>λ™μ‹ μ”μ²­ μ:</label>
            <input type="number" id="concurrentRequests" class="form-control" value="5" min="1" max="50">
            <small>λ™μ‹μ„± ν…μ¤νΈλ¥Ό μ„ν•΄ κ°™μ€ μ”μ²­μ„ μ—¬λ¬ λ² λ™μ‹μ— λ³΄λƒ…λ‹λ‹¤</small>
        </div>

        <div class="button-group">
            <button onclick="createOrder('v1')" class="btn btn-danger">
                π”΄ V1λ΅ μ£Όλ¬Έ (λ™μ‹μ„± μ΄μ λ°μƒ)
            </button>
            <button onclick="createOrder('v2')" class="btn btn-success">
                πΆ V2λ΅ μ£Όλ¬Έ (ν•΄κ²° λ²„μ „)
            </button>
            <button onclick="createOrderConcurrent('v1')" class="btn btn-danger-outline">
                π”΄ V1 λ™μ‹ μ”μ²­ ν…μ¤νΈ
            </button>
            <button onclick="createOrderConcurrent('v2')" class="btn btn-success-outline">
                πΆ V2 λ™μ‹ μ”μ²­ ν…μ¤νΈ
            </button>
        </div>
    </section>

    <!-- λ©”μΈ μ½ν…μΈ  μμ—­ -->
    <div class="main-content">
        <!-- μΆμΈ΅: λ°μ΄ν„° ν„ν™© -->
        <div class="left-panel">
            <section class="data-section">
                <div class="data-column">
                    <h2>π“¦ μƒν’ μ¬κ³ </h2>
                    <button onclick="refreshData()" class="btn btn-small">μƒλ΅κ³ μΉ¨</button>
            <table class="data-table">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>μƒν’λ…</th>
                    <th>μ¬κ³ </th>
                    <th>κ°€κ²©</th>
                </tr>
                </thead>
                <tbody id="productsTable">
                <tr th:each="product : ${products}">
                    <td th:text="${product.id}"></td>
                    <td th:text="${product.name}"></td>
                    <td th:text="${product.stockQuantity}" class="stock-count"></td>
                    <td th:text="${#numbers.formatInteger(product.price, 0, 'COMMA') + 'μ›'}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="data-column">
            <h2>π‘¥ μ‚¬μ©μ ν¬μΈνΈ</h2>
            <button onclick="refreshData()" class="btn btn-small">μƒλ΅κ³ μΉ¨</button>
            <table class="data-table">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>μ΄λ¦„</th>
                    <th>λ“±κΈ‰</th>
                    <th>ν¬μΈνΈ</th>
                </tr>
                </thead>
                <tbody id="usersTable">
                <tr th:each="user : ${users}">
                    <td th:text="${user.id}"></td>
                    <td th:text="${user.username}"></td>
                    <td th:text="${user.grade}"></td>
                    <td th:text="${#numbers.formatInteger(user.pointBalance, 0, 'COMMA')}" class="point-count"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="data-column">
            <h2>π« μΏ ν° μ‚¬μ© ν„ν™©</h2>
            <button onclick="refreshData()" class="btn btn-small">μƒλ΅κ³ μΉ¨</button>
            <table class="data-table">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>μΏ ν°λ…</th>
                    <th>μ‚¬μ©/μ „μ²΄</th>
                    <th>λ‚¨μ€ νμ</th>
                </tr>
                </thead>
                <tbody id="couponsTable">
                <tr th:each="coupon : ${coupons}">
                    <td th:text="${coupon.id}"></td>
                    <td th:text="${coupon.name}"></td>
                    <td th:text="${coupon.usedCount + '/' + coupon.totalAvailableCount}"></td>
                    <td th:text="${coupon.remainingCount}" class="coupon-count"></td>
                </tr>
                </tbody>
            </table>
                </div>
            </section>

            <!-- μ£Όλ¬Έ λ‚΄μ—­ -->
    <section class="orders-section">
        <h2>π“‹ μ£Όλ¬Έ λ‚΄μ—­</h2>
        <button onclick="refreshData()" class="btn btn-small">μƒλ΅κ³ μΉ¨</button>
        <div id="ordersContainer">
            <table class="data-table">
                <thead>
                <tr>
                    <th>μ£Όλ¬Έ ID</th>
                    <th>μ‚¬μ©μ ID</th>
                    <th>μƒνƒ</th>
                    <th>μ΄μ•΅</th>
                    <th>ν• μΈ</th>
                    <th>ν¬μΈνΈ μ‚¬μ©</th>
                    <th>μµμΆ… κΈμ•΅</th>
                    <th>μ£Όλ¬Έ μ‹κ°„</th>
                    <th>μ•΅μ…</th>
                </tr>
                </thead>
                <tbody id="ordersTable">
                <tr th:each="order : ${orders}">
                    <td th:text="${order.id}"></td>
                    <td th:text="${order.user.id}"></td>
                    <td th:text="${order.status}" th:classappend="${order.status == T(com.concurrency.shop.domain.order.OrderStatus).CONFIRMED} ? 'status-confirmed' : 'status-cancelled'"></td>
                    <td th:text="${#numbers.formatInteger(order.totalAmount, 0, 'COMMA') + 'μ›'}"></td>
                    <td th:text="${#numbers.formatInteger(order.discountAmount, 0, 'COMMA') + 'μ›'}"></td>
                    <td th:text="${#numbers.formatInteger(order.pointUsed, 0, 'COMMA')}"></td>
                    <td th:text="${#numbers.formatInteger(order.finalAmount, 0, 'COMMA') + 'μ›'}"></td>
                    <td th:text="${#temporals.format(order.orderDate, 'yyyy-MM-dd HH:mm:ss')}"></td>
                    <td>
                        <button th:onclick="'cancelOrder(' + ${order.id} + ', \'v1\')'" class="btn btn-xs btn-danger">V1 μ·¨μ†</button>
                        <button th:onclick="'cancelOrder(' + ${order.id} + ', \'v2\')'" class="btn btn-xs btn-success">V2 μ·¨μ†</button>
                    </td>
                </tr>
                </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- μ°μΈ΅: λ΅κ·Έ μμ—­ -->
        <div class="right-panel">
            <section class="log-section">
                <h2>π“ μ‹¤ν–‰ λ΅κ·Έ</h2>
                <button onclick="clearLog()" class="btn btn-small">λ΅κ·Έ μ§€μ°κΈ°</button>
                <div id="logContainer" class="log-container"></div>
            </section>
        </div>
    </div>
</div>

<script th:src="@{/js/dashboard.js}"></script>
</body>
</html>
